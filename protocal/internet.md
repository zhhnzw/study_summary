## 五层模型

#### 实体层
是把电脑连接起来的物理手段，作用是负责传送0和1的电信号。光缆、电缆、双绞线、无线电波等。

#### 链接层
确定了0和1的分组方式。

以太网协议在链接层，其数据包的头部信息包含了发送者的网卡地址和接受者的网卡地址(MAC地址)

广播: 在链接层还只能采用原始的广播通信方式(在同一个局域网下广播)

问题:此时并不知道对方的MAC地址, 如何把数据包只发送给指定的计算机？

#### 网络层
IP协议。IP地址和子网掩码的作用组合起来可以确定计算机所在的子网络

而链接层中MAC地址的作用是将数据包送到该子网络中的目标网卡

IP数据包是嵌套放在了以太网数据包的"数据"部分，一起发送

ARP协议。这个协议加上IP协议解答了链接层的问题

ARP协议: 在所在子网络中广播，数据包包含它所要查询主机的IP地址，当其他计算机收到这个数据包且发现与自身的IP地址一致时，向对方报告自己的MAC地址，否则就丢弃这个包

如果两台主机不在同一个子网络，那么就把数据包传送到两个子网络连接处的"网关"（gateway），让网关转发

此时，已经可以定位每一台主机在网络当中的位置

#### 传输层
建立"端口到端口"的通信

相比之下，"网络层"的功能是建立"主机到主机"的通信。

只要确定主机和端口，我们就能实现程序之间的交流。Unix系统就把主机+端口，叫做"套接字"（socket）

UDP和TCP协议

#### 应用层

如: HTTP

#### 五层模型总结
以太网协议解决了局域网的点对点通信

IP协议解决了多个局域网的通信问题

另：ARP协议作用是找出目标计算机的MAC地址，这样以太网协议组包时才能拿到这个值

#### 访问网页经历了什么？
以输入`http://www.baidu.com`网址为例

客户端发送请求:

通过DNS协议，向DNS服务器发数据包得到目标网址的ip地址

应用层是HTTP协议，嵌入了TCP数据包，需要建立TCP端对端的连接

接收方baidu的HTTP端口是80，发送方(本机)的端口是一个随机生成的1024-65535之间的整数

TCP数据包再嵌入IP数据包，IP数据包设置双方的IP地址

IP数据包嵌入以太网数据包，以太网数据包需要设置双方的MAC地址，发送方为本机的网卡MAC地址，接收方为网关的MAC地址（通过ARP协议得到）

数据包组装好后就可以发出去了，通过子网掩码判断这个ip地址是不是在同一个子网络，不在同一个子网络就需要通过网关转发数据包

服务器端响应:

经过多个网关的转发，baidu的服务器收到了以太网数据包，然后取出里面的TCP数据包

然后读出最内层的"HTTP请求"，做出"HTTP响应"，再用TCP协议发回给客户端

客户端收到HTTP响应后，浏览器就可以将网页渲染出来，完成一次网络通信。
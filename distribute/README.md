## 分布式

### 为什么需要分布式系统？

1. 单台机器的资源有极限
2. 解决单点故障：在单台机器上部署服务，如果机器出现故障导致服务挂了，那么整个系统就会崩溃了。因此就要提高系统的可用性，就需要分布式系统。

### 分布式理论基础

#### CAP理论

C：Consistency(强一致性)：如果系统对一个写操作返回成功，那么之后的读请求都必须读到这个新数据；如果返回失败，那么所有的读操作都不能读到这个数据。对调用者而言，数据具有强一致性。

A：Availability(可用性)：所有读写请求在一定时间内得到响应，可终止，不会一直等待。

P：Partition tolerance(分区容错 性)：在网络分区的情况下，被分隔的节点仍能正常对外服务。

由于网络硬件肯定会出现延迟丢包等问题，所以**分区容错性**是必须实现的。所以我们只能在**一致性**和**可用性**之间进行权衡。

**CAP理论的核心是：一个分布式系统不可能同时很好的满足一致性、可用性和分区容错性这三个需求，最多只能较好的满足两个。**

为什么呢？

假设分布式系统中有A、B两个节点，一个用作写功能，一个用作读功能，它们两之间通信的网络突然发生故障。那么，如果要实现强一致性，那么只能等它们两的通信恢复正常之后才能对外提供服务，此时就不满足可用性了；如果要选可用性，那么读数据，读到的就是旧数据，不满足强一致性。

#### 一致性与可用性的决择

对关系数据库来说，插入一条数据之后立刻查询，是肯定可以读出来这条数据的，但是对于很多web应用来说，并不要求这么高的实时性，比方说在微博发一条消息之后，过几秒乃至十几秒之后，我的订阅者才看到这条动态是完全可以接受的。

很多web实时系统并不要求严格的数据库事务，对读一致性的要求很低， 有些场合对写一致性要求并不高。允许实现**最终一致性**。

一致性和可用性之间取一个平衡。多余大多数web应用，其实并不需要强一致性。因此牺牲C换取P，这是目前分布式数据库产品的方向。

#### BASE理论

BASE就是为了解决关系数据库强一致性而引起的可用性降低而提出的解决方案。

BASE其实是下面三个术语的缩写：

- 基本可用(Basically Available)：允许可用性降低(可能延长响应时间，和服务降级)。
- 软状态(Soft state)：允许系统中的数据存在中间状态，比如：支付中。
- 最终一致(Eventually consistent)：允许节点之间的数据同步存在延迟，但在一定的期限后达到数据最终的一致性。

它的思想是通过**让系统放松对某一时刻数据一致性的要求来换取系统整体伸缩性和性能上改观**。为什么这么说呢，缘由就在于大型系统往往由于地域分布和极高性能的要求，不可能采用分布式事务来完成这些指标，要想获得这些指标，我们必须采用另外一种方式来完成，这里BASE就是解决这个问题的办法

### 分布式事务

### 分布式高可用

### 分布式任务调度

### 分布式缓存

### 分布式锁

### 分布式和集群的区别

* 分布式：不同的多台服务器上面部署**不同**的服务模块（工程），他们之间通过Rpc/Rmi之间通信和调用，对外提供服务和组内协作。

* 集群：不同的多台服务器上面部署**相同**的服务模块，通过分布式调度软件进行统一的调度，对外提供服务和连接。
